---
title: "S&DS625 Report"
author: "Zihan Wang"
date: "December 15th, 2023"
output:
  pdf_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo   =FALSE,      ## show or suppress the code
                      include=TRUE ,      ## show or suppress the output
                      message=FALSE,      ## omit messages generated by code
                      warning=FALSE,      ## omit warnings generated by code
                      comment=NA,         ## removes the ## from in front of outputs
                      fig.align="center", ## centers all figures
                      fig.height = 5,     ## set the default height
                      fig.weight = 5      ## set the default width
                      )

library(dplyr)
library(readr)
library(ggplot2)
```

## Abstract
As the data science job market burgeons, potential employees often grapple with gauging whether the salary offered aligns with market standards, due to the absence of a reference framework. Addressing this gap, This project delves into the analysis of data science-related job salaries, leveraging a dataset sourced from Kaggle. The dataset encompasses a range of attributes such as work year, experience level, employment type, job title, salary in USD, employee residence, remote ratio, and more. However, the focal point of the analysis rests on key predictors like experience level, job title, employee residence, and remote ratio to unveil their influence on salaries, measured in USD and adjusted for inflation based on the offer year.  The project employs linear regression and tree-based random forest models with different hyperparameters in its initial phase. Each model incorporates predictors such as job title, country of employee residence, work mode (remote, hybrid, on-site), and experience level (from entry to senior levels), with the inflation-adjusted salary in USD serving as the outcome variable. The findings from these models underscore a significant correlation between the stated predictors and data science job salaries, highlighting notable variations across different countries and experience levels. Subsequently, a comparative error analysis of various models led to the selection of the linear regression model for salary prediction. This choice was informed by comparing the mean squared error of the models, where linear regression model demonstrated a smallest squared error. The final model can predict the estimated salary based on the employee's residence, job title, employee residence, and remote ratio etc. The culmination of this analysis not only provides valuable insights into the salary dynamics within the data science domain but also underpins a web application designed to offer employees a benchmark for evaluating job offers in this field. This application, fueled by the linear regression model's predictions, stands as a testament to the practical applicability of the project's findings, empowering data science professionals with a robust tool for informed salary negotiations.


## Executive Summary
An executive summary is typically longer than the abstract, up to a page, could possibly contain key visualizations, tables, or other figures that help communicate either the raw data or the results of the model, and is intended for someone outside of the data science/analytics team of an organization. It is important to be as concise as possible, and describe each of those points above without using language that is overly technical and not part of commonly used English. The executive summary is a separate document. 

Note that in the abstract, executive summary, and throughout the report you should avoid using first-person singular pronouns like "I" and "me", even if you are the only author. Use "we" or use passive voice. 

## Section I: Introduction

The realm of data science is witnessing an unprecedented surge in job opportunities, reflecting the growing reliance on data-driven decision-making across various industries. With this surge comes a diverse range of salaries, influenced by multiple factors such as experience level, job title, geographical location, and working mode. This project is motivated by the need for a systematic approach to predict these salaries, providing data science professionals with a benchmark for evaluating job offers and helping them understand their market value.

The data underpinning this study is extracted from Kaggle, encompassing variables such as work year, experience level, employment type, job title, salary (both in local currency and USD), employee residence, remote ratio, company location, and company size. However, the core analysis focuses on predictors like experience level, job title, salary in USD, employee residence, and remote ratio. These factors are crucial in understanding the disparities in salaries across different conditions in the data science job market. The dataset is a comprehensive compilation of salary data across various countries, providing a global perspective on the data science job market.

Moving beyond the introduction, Section II delves into data exploration and visualization. This section reveals significant disparities in salaries when viewed across different variables such as experience level, job title, and geographic location. The analysis confirms that salaries in the data science field vary considerably under different conditions, highlighting the need for a predictive model.

In Section III, we develop a linear regression model to predict salaries based on the identified significant predictors. This model is used to estimate salaries under various conditions, reflecting the trends observed in Section II. The linear regression approach is chosen for its simplicity and interpretability, making it suitable for this kind of analysis.

Section IV discusses the results of the linear regression model, emphasizing its alignment with the trends observed in the data exploration phase. This section also provides a critical assessment of the model's performance, discussing its strengths and limitations in the context of salary prediction.

Finally, Section V concludes the report with a summary of findings, recommendations based on the analysis, and ideas for future research. This section will also touch on the potential implications of the study for data science professionals and employers alike, providing a broader perspective on the importance of salary prediction in the data science job market.

## Section II: Data exploration and visualization 

This section presents a comprehensive overview of the key variables within the dataset, revealing insightful trends and relationships that inform our understanding of the factors influencing data science job salaries. Through meticulous data exploration and visualization, we unearth patterns that underscore the relevance of the chosen predictors in relation to the salaries reported.
```{r}
data <- read_csv("../cleaned_jobs.csv")
data <- data %>%
  mutate(remote_ratio = as.factor(remote_ratio))

```


```{r}
avg_salary_plot <- function(column, col_name) {
  # Ensure the column is a symbol
  col_sym <- rlang::sym(column)
  
  # Calculate average salary and reorder the factor
  avg_salary <- data %>%
    group_by(!!col_sym) %>%
    summarize(avg_salary = mean(salary_in_usd, na.rm = TRUE)) %>%
    ungroup() %>% # Ungroup to ensure the mutate affects the entire dataframe
    mutate(!!col_sym := forcats::fct_reorder(!!col_sym, avg_salary, .desc = TRUE))

  ggplot(avg_salary, aes_string(x = column, y = "avg_salary", fill = column)) +
    geom_bar(stat = "identity", position = position_dodge()) +
    scale_y_continuous(labels = scales::comma) +
    labs(title = paste("Mean Salary by", col_name), x = col_name, y = "Mean Salary (in USD)") +
    theme_minimal() +
    scale_fill_brewer(palette = "Set1") +
    theme(legend.title = element_blank(),
          legend.position = "bottom",
          axis.text.x = element_text(hjust = 1))
}

```

#### Mean Salary by Experience Level
The first visualization showcases the mean salary delineated by experience level, revealing a clear stratification of earnings across different stages of professional development. Experienced (EX) professionals command the highest salaries, followed by senior (SE), mid-level (MI), and entry-level (EN) positions. This descending trend illustrates the premium placed on accumulated expertise within the data science field.

```{r}
avg_salary_plot("experience_level", "Experience Level")
```
#### Mean Salary by Remote Ratio
The second graph pivots to analyze the impact of remote working arrangements on salary. Here, a delineation is evident between fully remote (100), partial remote (50), and non-remote (0) roles. The findings indicate that full remote work does not necessarily translate to the highest salaries, prompting a deeper consideration of how workplace flexibility intersects with compensation.

```{r}
avg_salary_plot("remote_ratio", "Remote Ratio")
```

```{r}
avg_salary_plot2 <- function(column, col_name) {
  # Ensure the column is a symbol
  col_sym <- rlang::sym(column)
  
  # Calculate average salary and reorder the factor
  avg_salary <- data %>%
    group_by(!!col_sym) %>%
    summarize(avg_salary = mean(salary_in_usd, na.rm = TRUE)) %>%
    ungroup() %>% # Ungroup to ensure the mutate affects the entire dataframe
    mutate(!!col_sym := forcats::fct_reorder(!!col_sym, avg_salary, .desc = TRUE))

  ggplot(avg_salary, aes_string(x = column, y = "avg_salary")) +
    geom_bar(stat = "identity", position = position_dodge()) +
    scale_y_continuous(labels = scales::comma) +
    labs(title = paste("Mean Salary by", col_name), x = col_name, y = "Mean Salary (in USD)") +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
```

#### Mean Salary by Employee Residence
Delving into geographic influences, the third graph correlates mean salary with the employee's country of residence. The United States emerges as the top-paying country, followed closely by Canada and Ireland, descending through to Argentina. This gradient reflects the economic and industry-specific factors that shape salary benchmarks globally.
```{r}
avg_salary_plot2("employee_residence", "Employee Residence")
```
#### Mean Salary by Job Title
Lastly, we examine how different job titles within the data science umbrella correspond to salary variations. Research Scientists, Data Architects, and Machine Learning Engineers are among the top earners, with Business Intelligence Engineers and Data Analysts comparatively lower on the salary scale. This hierarchy reflects the market demand and perceived value of specialized skills.

```{r}
avg_salary_plot2("job_title", "Job Title")
```
These visualizations serve as a compelling prelude to the predictive modeling in Section III, where we construct and evaluate a linear regression model based on the highlighted predictors. The consistency of the trends observed here with the model's findings reinforces the conclusion that experience level, job title, employee residence, and remote ratio are significant determinants of salary in the data science domain. The visual evidence provided sets the stage for a nuanced discussion on the results of the model and their implications for data science professionals navigating the job market.

## Modeling/Analysis

# Normal Quantile Plot
Describe regression or classification model(s) used, or the analysis that was performed. For each regression or classification model, discuss 

- any assumptions that are made
- the observation, the predictors, and the outcome (aka the rows of $X$, the columns of $X$, and $y$)
- what model you are using, and write out the model
- what the coefficients mean (when applicable) and how this is related to your problem 
- appropriate measures of the performance of the model, such as measures of fit and predictive ability
- whether or not you think the model is appropriate for this kind of data, and why, and
- how easy/hard it is to interpret the results and explain them to either a technical or non-technical audience.

For other kinds of analysis, what you give is highly dependent on the type of analysis. But in general, talk about assumptions, if they are appropriate, how they might not be appropriate, and why you chose this type of analysis. 

## Visualization and interpretation of the results

# Regression Results (like Swimming report)
# Web: 5 web apps, one overall, four others with only one variable to select
Create visualizations of the results when appropriate, focusing on visualizations that 

- help describe aspects of the results that have real-world interpretation 
- help the reader understand how the model addresses the problem you are studying. 

**Visualizations are one of the most powerful ways to communicate information to the reader, so it is important to spend time producing clear, descriptive, eye-catching visualizations.**

Discuss the results of the model or models you chose, and describe how they are related to the problem statement or question that you were trying to answer in the project.  

If you have built multiple models or types of analysis, compare the measures of performance and the ease of interpretability across models or types of analysis, stating which model or models performed best, and which model or models were most interpretable.  Finally, decide which model or type of analysis is best for your particular problem based on some combination of performance and interpretability.

## Conclusions and recommendations
One or two paragraphs stating conclusions, recommendations, and ideas for future work and improvements.

## Appendix (optional)
Any supporting information or additional information that isn't necessary to have in the main body of the paper. For example, huge tables can go here, especially if they are more than one page. Tables that are, for example, 100 pages most likely should not be included at all. 
